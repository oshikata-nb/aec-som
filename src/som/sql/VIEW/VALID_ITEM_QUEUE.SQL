CREATE OR REPLACE VIEW AP21.VALID_ITEM_QUEUE
    (ITEM_CD,VERSION,ITEM_TYPE,ACTIVE_DATE,STATUS,ITEM_NAME,ITEM_SUB_NAME,
    PRODUCT_DIVISION,ARTICLE_DIVISION,PURCHASE_DIVISION,PARENT_ITEM_CD,
    ITEM_CATEGORY,PHANTOM_DIVISION,SPOT_DIVISION,STOCK_DIVISION,BULK_DIVISION,
    DEFAULT_LOCATION,COST_DIVISION,LOT_DIVISION,NEW_FLG,RESEARCH_ITEM,SHIPPER_DIVISION,
    TYPE_DIVISION,OTHER_COMPANY_CD1,ORDER_LOCATION,STYLE_OF_PACKING,NUMBER_OF_INSERTIONS,
    ALL_UP_WEIGHT,UNIT_OF_OPERATION_MANAGEMENT,UNIT_OF_STOCK_CONTROL,KG_OF_FRACTION_MANAGEMENT,
    UNIT_OF_FRACTION_MANAGEMENT,KG_CONVERSION_COEFFICIENT,WATER_DIVISION,
    INPUT_DATE,INPUTOR_CD,UPDATE_DATE,UPDATOR_CD,DEVELOPMENT_REQUEST_NO)
AS
SELECT ITEM_QUEUE."ITEM_CD"
	   ,DECODE(ITEM.VERSION, NULL, ITEM_QUEUE.VERSION, ITEM."VERSION") VERSION
	   ,ITEM."ITEM_TYPE"
	   ,ITEM."ACTIVE_DATE"
	   ,ITEM."STATUS"
	   ,ITEM."ITEM_NAME"
	   ,ITEM."ITEM_SUB_NAME"
	   ,ITEM."PRODUCT_DIVISION"
	   ,ITEM."ARTICLE_DIVISION"
	   ,ITEM."PURCHASE_DIVISION"
	   ,ITEM."PARENT_ITEM_CD"
	   ,ITEM."ITEM_CATEGORY"
	   ,ITEM."PHANTOM_DIVISION"
	   ,ITEM."SPOT_DIVISION"
	   ,ITEM."STOCK_DIVISION"
	   ,ITEM."BULK_DIVISION"
	   ,ITEM."DEFAULT_LOCATION"
	   ,ITEM."COST_DIVISION"
	   ,ITEM."LOT_DIVISION"
	   ,ITEM."NEW_FLG"
	   ,ITEM."RESEARCH_ITEM"
	   ,ITEM_QUEUE."SHIPPER_DIVISION"
	   ,ITEM_QUEUE."TYPE_DIVISION"
	   ,ITEM_QUEUE."OTHER_COMPANY_CD1"
	   ,ITEM."ORDER_LOCATION"
	   ,ITEM."STYLE_OF_PACKING"
	   ,ITEM."NUMBER_OF_INSERTIONS"
	   ,ITEM."ALL_UP_WEIGHT"
	   ,ITEM."UNIT_OF_OPERATION_MANAGEMENT"
	   ,ITEM."UNIT_OF_STOCK_CONTROL"
	   ,ITEM."KG_OF_FRACTION_MANAGEMENT"
	   ,ITEM."UNIT_OF_FRACTION_MANAGEMENT"
	   ,ITEM."KG_CONVERSION_COEFFICIENT"
	   ,ITEM."WATER_DIVISION"
	   ,ITEM."INPUT_DATE"
	   ,ITEM."INPUTOR_CD"
	   ,ITEM."UPDATE_DATE"
	   ,ITEM."UPDATOR_CD"
	   ,ITEM."DEVELOPMENT_REQUEST_NO"
FROM   ITEM_QUEUE
	  ,ITEM
	  ,(SELECT ITEM_QUEUE.ITEM_CD
			  ,MAX(ITEM_QUEUE.VERSION) VERSION
		FROM   ITEM_QUEUE
			  ,ARTICLE_ATTRIBUTE_QUEUE  ARTICLE
			  ,PRODUCT_ATTRIBUTE_QUEUE  PRODUCT
			  ,PURCHASE_ATTRIBUTE_QUEUE PURCHASE
		WHERE  ACTIVE_DATE <= SYSDATE
		AND    ITEM_QUEUE.ITEM_CD = ARTICLE.ITEM_CD(+)
		AND    ITEM_QUEUE.VERSION = ARTICLE.VERSION(+)
		AND    ITEM_QUEUE.ITEM_CD = PRODUCT.ITEM_CD(+)
		AND    ITEM_QUEUE.VERSION = PRODUCT.VERSION(+)
		AND    ITEM_QUEUE.ITEM_CD = PURCHASE.ITEM_CD(+)
		AND    ITEM_QUEUE.VERSION = PURCHASE.VERSION(+)
		GROUP  BY ITEM_QUEUE.ITEM_CD) MAX_ITEM_QUEUE
WHERE  ITEM_QUEUE.ITEM_CD = MAX_ITEM_QUEUE.ITEM_CD
AND    ITEM_QUEUE.VERSION = MAX_ITEM_QUEUE.VERSION
AND    ITEM_QUEUE.ITEM_CD = ITEM.ITEM_CD(+)
/
COMMENT ON TABLE AP21.VALID_ITEM_QUEUE IS '有効品目キュー'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ITEM_CD IS '品目コード'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.VERSION IS 'バージョン'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ITEM_TYPE IS '品目タイプ(未使用)'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ACTIVE_DATE IS '有効日時'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.STATUS IS 'ステータス|1:入力中,2:承認依頼中,3:承認済み,4:研究用'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ITEM_NAME IS '品目名称'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ITEM_SUB_NAME IS '品目サブ名称'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.PRODUCT_DIVISION IS '製造品区分|0:該当なし,1:製品,2:中間品,3:充填品,4:応用試作品'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ARTICLE_DIVISION IS '販売品区分|0:該当なし,1:商品,2:仕入商品,3:受託品'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.PURCHASE_DIVISION IS '購入品区分|0:該当なし,1:原料,2:材料,3:副資材,4:部品,5:設備,6:製品'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.PARENT_ITEM_CD IS '代表品目コード'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ITEM_CATEGORY IS '品目分類コード'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.PHANTOM_DIVISION IS 'ファントム区分(未使用)|1:通常,2:ファントム'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.SPOT_DIVISION IS 'スポット区分|1:通常,2:スポット'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.STOCK_DIVISION IS '在庫管理区分|1:通常,2:在庫表除外,3:更新除外'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.BULK_DIVISION IS 'バルク区分(未使用)|1:通常,2:バルク出庫'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.DEFAULT_LOCATION IS '基準保管場所'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.COST_DIVISION IS '原価区分(未使用)'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.LOT_DIVISION IS 'ロット管理区分|1:しない,2:する'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.NEW_FLG IS '新規取扱フラグ(未使用)|1:新規'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.RESEARCH_ITEM IS '研究用品目|1:研究用以外 2:研究用'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.SHIPPER_DIVISION IS '荷主|0:自社,1:花王,2:OEM,3:油脂'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.TYPE_DIVISION IS '種別|0:製品,1:原料,2:包材,3:中間品,4:仕入直送品,5:仕入在庫品,6:外注品(直送),7:外注品(非直送),9:その他'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.OTHER_COMPANY_CD1 IS '他社コード1'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ORDER_LOCATION IS '発注まとめ場所'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.STYLE_OF_PACKING IS '荷姿'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.NUMBER_OF_INSERTIONS IS '入数'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.ALL_UP_WEIGHT IS '総重量'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.UNIT_OF_OPERATION_MANAGEMENT IS '運用管理単位'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.UNIT_OF_STOCK_CONTROL IS '在庫管理単位'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.KG_OF_FRACTION_MANAGEMENT IS 'Kg換算係数（在庫）'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.UNIT_OF_FRACTION_MANAGEMENT IS '端数管理単位'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.KG_CONVERSION_COEFFICIENT IS 'Kg換算係数（端数）'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.WATER_DIVISION IS '水区分|1:水以外,2:水'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.INPUT_DATE IS '登録日時'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.INPUTOR_CD IS '登録者ID'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.UPDATE_DATE IS '更新日時'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.UPDATOR_CD IS '更新者ID'
/
COMMENT ON COLUMN AP21.VALID_ITEM_QUEUE.DEVELOPMENT_REQUEST_NO IS '開発依頼NO(未使用)'
/
