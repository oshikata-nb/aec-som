CREATE OR REPLACE VIEW REP_BILLISSUE_HEADER
    (CLAIM_NO,ORGANIZATION_CD,VENDER_CD,CREDIT_DATE,CREDIT_SCHEDULED_DATE,
    CREDIT_DIVISION,NOTE_SIGHT,HOLIDAY_FLG,CLAIM_AMOUNT_FORWARD,CREDIT_AMOUNT_FORWARD,
    OTHER_CREDIT_AMOUNT_FORWARD,BALANCE_FORWARD,SALES_AMOUNT,SALES_RETURNED_AMOUNT,
    SALES_DISCOUNT_AMOUNT,OTHER_SALES_AMOUNT,OFFSET_AMOUNT,TAX_AMOUNT,CLAIM_AMOUNT,
    CLAIM_BALANCE_AMOUNT,ERASER_AMOUNT,ERASER_BALANCE_AMOUNT,BILL_DIVISION,
    ISSUE_DATE,ISSUER_CD,INPUT_DATE,INPUTOR_CD,UPDATE_DATE,UPDATOR_CD,VENDER_NAME1,
    VENDER_NAME2,VEN_ZIPCODE_NO,VEN_ADDRESS1,VEN_ADDRESS2,VEN_TEL_NO,VEN_FAX_NO,
    HOME_NAME,ORGANIZATION_NAME,ORG_ZIPCODE_NO,ORG_ADDRESS,ORG_TEL_NO,ORG_FAX_NO,
    HENPIN_SONOTA,TOTAL_SALES_AMOUNT)
AS
SELECT CLA.CLAIM_NO
      ,CLA.ORGANIZATION_CD
      ,CLA.VENDER_CD
      ,CLA.CREDIT_DATE
      ,CLA.CREDIT_SCHEDULED_DATE
      ,CLA.CREDIT_DIVISION
      ,CLA.NOTE_SIGHT
      ,CLA.HOLIDAY_FLG
      ,CLA.CLAIM_AMOUNT_FORWARD
      ,CLA.CREDIT_AMOUNT_FORWARD
      ,CLA.OTHER_CREDIT_AMOUNT_FORWARD
      ,CLA.BALANCE_FORWARD
      ,CLA.SALES_AMOUNT
      ,CLA.SALES_RETURNED_AMOUNT
      ,CLA.SALES_DISCOUNT_AMOUNT
      ,CLA.OTHER_SALES_AMOUNT
      ,CLA.OFFSET_AMOUNT
      ,CLA.TAX_AMOUNT
      ,CLA.CLAIM_AMOUNT
      ,CLA.CLAIM_BALANCE_AMOUNT
      ,CLA.ERASER_AMOUNT
      ,CLA.ERASER_BALANCE_AMOUNT
      ,CLA.BILL_DIVISION
      ,CLA.ISSUE_DATE
      ,CLA.ISSUER_CD
      ,CLA.INPUT_DATE
      ,CLA.INPUTOR_CD
      ,CLA.UPDATE_DATE
      ,CLA.UPDATOR_CD
      ,VEN.VENDER_NAME1
      ,VEN.VENDER_NAME2
      ,VEN.ZIPCODE_NO AS VEN_ZIPCODE_NO
      ,VEN.ADDRESS1 || VEN.ADDRESS2 AS VEN_ADDRESS1
      ,VEN.ADDRESS3 AS VEN_ADDRESS2
      ,VEN.TEL_NO AS VEN_TEL_NO
      ,VEN.FAX_NO AS VEN_FAX_NO
      ,(SELECT HOME_NAME1 FROM COMPANY WHERE COMPANY_CD = '000001') AS HOME_NAME
      ,ORG.ORGANIZATION_NAME
      ,ORG.ZIPCODE_NO AS ORG_ZIPCODE_NO
      ,ORG.ADDRESS1 || ORG.ADDRESS2 || ORG.ADDRESS3 AS ORG_ADDRESS
      ,ORG.TEL_NO AS ORG_TEL_NO
      ,ORG.FAX_NO AS ORG_FAX_NO
      ,CLA.SALES_RETURNED_AMOUNT + CLA.SALES_DISCOUNT_AMOUNT +
       CLA.OTHER_SALES_AMOUNT AS HENPIN_SONOTA
      ,CLA.SALES_AMOUNT -
       (CLA.SALES_RETURNED_AMOUNT + CLA.SALES_DISCOUNT_AMOUNT +
       CLA.OTHER_SALES_AMOUNT) + CLA.TAX_AMOUNT TOTAL_SALES_AMOUNT

FROM   CLAIM_HEADER CLA, VENDER VEN, ORGANIZATION ORG

WHERE  CLA.VENDER_CD = VEN.VENDER_CD
AND    VEN.VENDER_DIVISION = 'TS'
AND    CLA.ORGANIZATION_CD = ORG.ORGANIZATION_CD

UNION ALL

SELECT TMPCLA.CLAIM_NO
      ,TMPCLA.ORGANIZATION_CD
      ,TMPCLA.VENDER_CD
      ,TMPCLA.CREDIT_DATE
      ,TMPCLA.CREDIT_SCHEDULED_DATE
      ,TMPCLA.CREDIT_DIVISION
      ,TMPCLA.NOTE_SIGHT
      ,TMPCLA.HOLIDAY_FLG
      ,TMPCLA.CLAIM_AMOUNT_FORWARD
      ,TMPCLA.CREDIT_AMOUNT_FORWARD
      ,TMPCLA.OTHER_CREDIT_AMOUNT_FORWARD
      ,TMPCLA.BALANCE_FORWARD
      ,TMPCLA.SALES_AMOUNT
      ,TMPCLA.SALES_RETURNED_AMOUNT
      ,TMPCLA.SALES_DISCOUNT_AMOUNT
      ,TMPCLA.OTHER_SALES_AMOUNT
      ,TMPCLA.OFFSET_AMOUNT
      ,TMPCLA.TAX_AMOUNT
      ,TMPCLA.CLAIM_AMOUNT
      ,TMPCLA.CLAIM_BALANCE_AMOUNT
      ,TMPCLA.ERASER_AMOUNT
      ,TMPCLA.ERASER_BALANCE_AMOUNT
      ,TMPCLA.BILL_DIVISION
      ,TMPCLA.ISSUE_DATE
      ,TMPCLA.ISSUER_CD
      ,TMPCLA.INPUT_DATE
      ,TMPCLA.INPUTOR_CD
      ,TMPCLA.UPDATE_DATE
      ,TMPCLA.UPDATOR_CD
      ,VEN.VENDER_NAME1
      ,VEN.VENDER_NAME2
      ,VEN.ZIPCODE_NO AS VEN_ZIPCODE_NO
      ,VEN.ADDRESS1 || VEN.ADDRESS2 AS VEN_ADDRESS1
      ,VEN.ADDRESS3 AS VEN_ADDRESS2
      ,VEN.TEL_NO AS VEN_TEL_NO
      ,VEN.FAX_NO AS VEN_FAX_NO
      ,(SELECT HOME_NAME1 FROM COMPANY WHERE COMPANY_CD = '000001') AS HOME_NAME
      ,ORG.ORGANIZATION_NAME
      ,ORG.ZIPCODE_NO AS ORG_ZIPCODE_NO
      ,ORG.ADDRESS1 || ORG.ADDRESS2 || ORG.ADDRESS3 AS ORG_ADDRESS
      ,ORG.TEL_NO AS ORG_TEL_NO
      ,ORG.FAX_NO AS ORG_FAX_NO
      ,TMPCLA.SALES_RETURNED_AMOUNT + TMPCLA.SALES_DISCOUNT_AMOUNT +
       TMPCLA.OTHER_SALES_AMOUNT AS HENPIN_SONOTA
      ,TMPCLA.SALES_AMOUNT -
       (TMPCLA.SALES_RETURNED_AMOUNT + TMPCLA.SALES_DISCOUNT_AMOUNT +
       TMPCLA.OTHER_SALES_AMOUNT) + TMPCLA.TAX_AMOUNT TOTAL_SALES_AMOUNT

FROM   TEMPORARY_CLAIM_HEADER TMPCLA, VENDER VEN, ORGANIZATION ORG

WHERE  TMPCLA.VENDER_CD = VEN.VENDER_CD
AND    VEN.VENDER_DIVISION = 'TS'
AND    TMPCLA.ORGANIZATION_CD = ORG.ORGANIZATION_CD
/
COMMENT ON TABLE REP_BILLISSUE_HEADER IS 'REP_請求書ヘッダ'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CLAIM_NO IS '請求番号'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORGANIZATION_CD IS '部署コード'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VENDER_CD IS '請求先コード'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CREDIT_DATE IS '請求締め日'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CREDIT_SCHEDULED_DATE IS '入金予定日'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CREDIT_DIVISION IS '入金分類(決済方法)'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.NOTE_SIGHT IS '手形サイト'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.HOLIDAY_FLG IS '休日指定フラグ|1:前倒し 2:先送り 3:休日を考慮しない'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CLAIM_AMOUNT_FORWARD IS '前回請求額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CREDIT_AMOUNT_FORWARD IS '前回入金額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.OTHER_CREDIT_AMOUNT_FORWARD IS '前回その他入金額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.BALANCE_FORWARD IS '差引繰越額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.SALES_AMOUNT IS '今回売上額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.SALES_RETURNED_AMOUNT IS '返品金額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.SALES_DISCOUNT_AMOUNT IS '値引金額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.OTHER_SALES_AMOUNT IS 'その他売上金額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.OFFSET_AMOUNT IS '相殺'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.TAX_AMOUNT IS '消費税額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CLAIM_AMOUNT IS '今回請求額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.CLAIM_BALANCE_AMOUNT IS '未請求額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ERASER_AMOUNT IS '消込額'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ERASER_BALANCE_AMOUNT IS '消込残'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.BILL_DIVISION IS '請求書発行済フラグ|0:未発行 1:発行 9:発行不要'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ISSUE_DATE IS '発行日'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ISSUER_CD IS '発行者ID'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.INPUT_DATE IS '登録日時'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.INPUTOR_CD IS '登録者ID'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.UPDATE_DATE IS '更新日時'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.UPDATOR_CD IS '更新者ID'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VENDER_NAME1 IS '請求先名称1'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VENDER_NAME2 IS '請求先名称2'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VEN_ZIPCODE_NO IS '請求先郵便番号'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VEN_ADDRESS1 IS '請求先住所1,2'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VEN_ADDRESS2 IS '請求先住所3'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VEN_TEL_NO IS '請求先TEL'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.VEN_FAX_NO IS '請求先FAX'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.HOME_NAME IS '自社名'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORGANIZATION_NAME IS '部署名'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORG_ZIPCODE_NO IS '部署郵便番号'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORG_ADDRESS IS '部署住所'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORG_TEL_NO IS '部署TEL'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.ORG_FAX_NO IS '部署FAX'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.HENPIN_SONOTA IS '返品・その他'
/
COMMENT ON COLUMN REP_BILLISSUE_HEADER.TOTAL_SALES_AMOUNT IS '今回売上合計'
/
